<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Negociação de conteúdo HTTP - Inphinit PHP</title>
  <meta name="description" content="A negociação de conteúdo é o mecanismo usado para fornecer diferentes representações de um recurso para o mesmo URI (por exemplo, idioma, formato ou codificação)">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">
  <link rel="stylesheet" type="text/css" href="/css/docs.1766454348.css" media="all">
  <link rel="alternate" href="/en/docs/http/content-negotiation.html" hreflang="en">
  <link rel="alternate" href="/pt/docs/http/content-negotiation.html" hreflang="pt">
  <script src="/js/docs.1766454348.js"></script>
</head>
<body>
  <div id="container">
    <main>
      <h1>Negociação de conteúdo HTTP</h1>
      <p>
        A negociação de conteúdo é o mecanismo usado para fornecer diferentes representações de um recurso para o mesmo URI (por exemplo, idioma, formato ou codificação).
      </p>

      <p>
        Quando um cliente solicita um recurso, ele o faz usando uma URL. Com base nessa URL, o servidor seleciona uma das variantes disponíveis — chamadas representações — e retorna a representação apropriada para o cliente. Tanto o recurso em si quanto cada uma de suas representações possuem suas próprias URLs. A negociação de conteúdo define como o servidor escolhe qual representação retornar quando o recurso é solicitado.
      </p>

      <p>
        A especificação HTTP/1.1 define um conjunto de cabeçalhos de solicitação padrão que iniciam a negociação de conteúdo orientada pelo servidor, como <code>Accept</code>, <code>Accept-Encoding</code>, e <code>Accept-Language</code>.
      </p>

      <!-- quality values (q-value; q-factor) -->

      <section>
        <h2 id="Constants">
          <a href="#constants">Constantes</a>
        </h2>

        <div class="box">
          <table>
            <thead>
              <tr><th>Constante</th>
              <th>Descrição</th>
            </tr></thead>
            <tbody>
              <tr>
                <td><code>Negotiation::ALL</code></td>
                <td>
                  Obter todos os valores de um cabeçalho Accept (sem o fator Q)
                </td>
              </tr>
              <tr>
                <td><code>Negotiation::LOW</code></td>
                <td>
                  Ordene os valores no cabeçalho do menor para o maior pelos fatores q.
                </td>
              </tr>
              <tr>
                <td><code>Negotiation::HIGH</code></td>
                <td>
                  Ordene os valores no cabeçalho do maior para o menor pelos fatores q.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section>
        <h2 id="api">
          <a href="#api">API</a>
        </h2>

        <div class="box">
          <table>
            <thead>
              <tr><th>Método</th>
              <th>Uso equivalente</th>
              <th>Descrição</th>
            </tr></thead>
            <tbody>
              <tr>
                <td><code>contentTypes(int $sort = self::HIGH): array</code></td>
                <td><code>...-&gt;entries('accept', ...)</code></td>
                <td>Retorna todos valores do header Accept, ordenado pelo segundo parametro</td>
              </tr>
              <tr>
                <td><code>encodings(int $sort = self::HIGH): array</code></td>
                <td><code>...-&gt;entries('accept-encoding', ...)</code></td>
                <td>Retorna todos valores do header Accept-Encondig, ordenado pelo segundo parametro</td>
              </tr>
              <tr>
                <td><code>languages(int $sort = self::HIGH): array</code></td>
                <td><code>...-&gt;entries('accept-language', ...)</code></td>
                <td>Retorna todos valores do header Accept-Language, ordenado pelo segundo parametro</td>
              </tr>
              <tr>
                <td><code>topContentType(): string|mixed</code></td>
                <td><code>...-&gt;top('accept-encondig')</code></td>
                <td>Retorna tipo de documento prioritário no cabeçalho Accept</td>
              </tr>
              <tr>
                <td><code>topEncondig(): string|mixed</code></td>
                <td><code>...-&gt;top('accept-encondig')</code></td>
                <td>Retorna codificação prioritária no cabeçalho Accept-Encondig</td>
              </tr>
              <tr>
                <td><code>topLanguage(): string|mixed</code></td>
                <td><code>...-&gt;top('accept-language')</code></td>
                <td>Retorna idioma prioritário no cabeçalho Accept-Language</td>
              </tr>
              <tr>
                <td><code>fromString(string $str): Negotiation</code></td>
                <td></td>
                <td>Cria uma instância de <code>Negotiation</code> baseada em uma string</td>
              </tr>
              <tr>
                <td><code>qFactor($value, $sort = self::HIGH): array</code></td>
                <td></td>
                <td>Analisa e obtêm os itens ordenados de um único valor</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section>
        <h2 href="#accept">
          <a href="#accept">Cabeçalho Accept</a>
        </h2>

        <p>Se você tiver uma solicitação HTTP como:</p>

        <div class="box">
          <code data-lang="conf" tabindex="0">
          GET /foo/bar HTTP/1.1
          Accept: image/avif,image/webp,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
          </code>
        </div>

        <p>O exemplo a seguir retornará <code>image/avif</code>, que é o valor com o maior q-value:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          echo $negotiation-&gt;getContentType();
          </code>
        </div>

        <p>Retorna todos os valores em <em>Accept</em> ordenados do maior para o menor q-value como uma matriz:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          print_r($negotiation-&gt;contentTypes(Negotiation::HIGH));
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [image/avif] =&gt; 1
              [image/webp] =&gt; 1
              [image/png] =&gt; 1
              [image/svg+xml] =&gt; 1
              [image/*] =&gt; 0.8
              [*/*] =&gt; 0.5
          )
          </code>
        </div>

        <p>Retorna todos os valores em <em>Accept</em> ordenados do menor para o maior q-value como uma matriz:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          print_r($negotiation-&gt;contentTypes(Negotiation::LOW));
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [*/*] =&gt; 0.5
              [image/*] =&gt; 0.8
              [image/svg+xml] =&gt; 1
              [image/png] =&gt; 1
              [image/webp] =&gt; 1
              [image/avif] =&gt; 1
          )
          </code>
        </div>
      </section>

      <section>
        <h2 href="#accept-encoding">
          <a href="#accept-encoding">Cabeçalho Accept-Encoding</a>
        </h2>

        <p>Se você tiver uma solicitação HTTP como:</p>

        <div class="box">
          <code data-lang="conf" tabindex="0">
          GET /foo/bar HTTP/1.1
          Accept-Encoding: br;q=1.0, gzip;q=0.8, *;q=0.1
          </code>
        </div>

        <p>O exemplo a seguir retornará <code>br</code>, que é o valor com o maior q-value:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          echo $negotiation-&gt;getEncoding();
          </code>
        </div>

        <p>Retorna todos valores em <em>Accept-Encodings</em> ordenados do maior para o menor q-value como uma matriz:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          print_r($negotiation-&gt;encodings(Negotiation::HIGH));
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [br] =&gt; 1
              [gzip] =&gt; 0.8
              [*] =&gt; 0.1
          )
          </code>
        </div>

        <p>Retorna todos valores em <em>Accept-Encoding</em> ordenados do menor para o maior q-value como uma matriz:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          print_r($negotiation-&gt;encodings(Negotiation::LOW));
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [*] =&gt; 0.1
              [gzip] =&gt; 0.8
              [br] =&gt; 1
          )
          </code>
        </div>
      </section>

      <section>
        <h2 href="#accept-language">
          <a href="#accept-language">Cabeçalho Accept-Language</a>
        </h2>

        <p>Se você tiver uma solicitação HTTP como:</p>

        <div class="box">
          <code data-lang="conf" tabindex="0">
          GET /foo/bar HTTP/1.1
          Accept-Language: fr-CH, fr;q=0.9, en;q=0.8, de;q=0.7, *;q=0.5
          </code>
        </div>

        <p>O exemplo a seguir retornará <code>fr-CH</code>, que é o valor com o maior q-value:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          echo $negotiation-&gt;getLanguage();
          </code>
        </div>

        <p>Retorna todos valores em <em>Accept-Language</em> ordenados do maior para o menor q-value como uma matriz:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          print_r($negotiation-&gt;languages(Negotiation::HIGH));
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [fr-CH] =&gt; 1
              [fr] =&gt; 0.9
              [en] =&gt; 0.8
              [de] =&gt; 0.7
              [*] =&gt; 0.5
          )
          </code>
        </div>

        <p>Retorna todos valores em <em>Accept-Language</em> ordenados do menor para o maior q-value como uma matriz:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();
          print_r($negotiation-&gt;languages(Negotiation::LOW));
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [*] =&gt; 0.5
              [de] =&gt; 0.7
              [en] =&gt; 0.8
              [fr] =&gt; 0.9
              [fr-CH] =&gt; 1
          )
          </code>
        </div>
      </section>

      <section>
        <h2 id="other-headers-with-quality-values">
          <a href="#other-headers-with-quality-values">Outros cabeçalhos com valores de qualidade</a>
        </h2>

        <p>Exemplo de solicitação:</p>

        <div class="box">
          <code data-lang="conf" tabindex="0">
          GET /foo/bar HTTP/1.1
          TE: gzip; q=1.0, deflate; q=0.8
          Custom: foo, bar;q=0.9, baz;q=0.8, quux;q=0.7, waldo;q=0.5
          </code>
        </div>

        <p>Uso:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Http\Negotiation;

          $negotiation = new Negotiation();

          $te = $negotiation-&gt;top('te', Negotiation::HIGH);
          var_dump($te);

          $te = $negotiation-&gt;entries('te', Negotiation::HIGH);
          print_r($te);

          $te = $negotiation-&gt;top('custom', Negotiation::HIGH);
          var_dump($te);

          $custom = $negotiation-&gt;entries('custom', Negotiation::HIGH);
          print_r($custom);
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          string(4) "gzip"
          Array
          (
              [gzip] =&gt; 1
              [deflate] =&gt; 0.8
          )
          string(3) "foo"
          Array
          (
              [foo] =&gt; 1
              [bar] =&gt; 0.9
              [baz] =&gt; 0.8
              [quux] =&gt; 0.7
              [waldo] =&gt; 0.5
          )
          </code>
        </div>
      </section>

      <section>
        <h2 id="parsing-string">
          <a href="#parsing-string">Analisando strings</a>
        </h2>

        <h3>Analisando cabeçalhos</h3>

        <p>
          O analisador sintático interno pode ser usado independentemente de requisições HTTP, permitindo sua reutilização em outros contextos ou até mesmo em implementações personalizadas de cliente-servidor. Exemplo:
        </p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $str = &lt;&lt;&lt;EOT
          Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
          Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3
          Accept-Encoding: gzip, deflate, br, zstd
          EOT;

          $negotiation = Negotiation::fromString($str);

          ...
          </code>
        </div>

        <h3>Analisando valores de qualidade</h3>

        <p>
          É possível analisar valores de qualidade (valores q ou fatores q) independentemente do contexto do cabeçalho, tornando seu uso bastante flexível:
        </p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $input = 'mesh/capsule;q=0.2,mesh/cube;q=0.9,mesh/cylinder;q=0.5,mesh/plane;q=0.4,mesh/quad;q=0.3,mesh/sphere;q=0.8';

          $entries = Negotiation::qFactor($input, Negotiation::HIGH);

          print_r($entries);
          </code>
        </div>

        <p>Saída:</p>

        <div class="box">
          <code data-lang="none" tabindex="0">
          Array
          (
              [mesh/cube] =&gt; 0.9
              [mesh/sphere] =&gt; 0.8
              [mesh/cylinder] =&gt; 0.5
              [mesh/plane] =&gt; 0.4
              [mesh/quad] =&gt; 0.3
              [mesh/capsule] =&gt; 0.2
          )
          </code>
        </div>
      </section>

      <!-- <section>
        <h2 id="q-factor">
          <a href="#q-factor">Q-Factor</a>
        </h2>

        <p>
          <code>Negotiation::qFactor($value, $sort = self::HIGH)</code>
        </p>
      </section> -->

      <footer>
        <div></div>
        <a href="/pt/docs/http/request.html" class="info" rel="prev">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" role="img">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 12H5M5 12L12 19M5 12L12 5"></path>
          </svg>
          <p>Requisição HTTP</p>
        </a>
      </footer>
    </main>
    <footer>
      <div>
        <p>Última atualização em <time datetime="2025-12-22">22 de Novembro de 2025</time>.</p>
        <p>Conteúdo licenciado sob CC BY-SA.</p>
      </div>
      <div>
        <p>
          Layout criado por <a rel="external" target="_blank" href="https://github.com/brcontainer">Brcontainer</a>
        </p>
      </div>
    </footer>
  </div>

  <header>
    <a href="/">Página inicial</a>
    <div>
      <!--
      <form method="get" id="search" action="http://duckduckgo.com/">
        <input type="hidden" name="sites" value="inphinit.github.io"/>
        <input type="hidden" name="k8" value="#444444"/>
        <input type="hidden" name="k9" value="#D51920"/>
        <input type="hidden" name="kt" value="h"/>
        <input type="text" name="q" maxlength="255" placeholder="Search&hellip;"/>
        <input type="submit" value="DuckDuckGo Search" style="visibility: hidden;" />
      </form>
      -->
      <a
        href="https://github.com/inphinit/inphinit"
        rel="external"
        target="_blank"
        aria-label="Access Github for get source">
        <svg
          fill="currentColor"
          viewBox="0 0 24 24"
          role="img"
          class="icon">
          <path d="M12 1.602c-6.077 0-11 4.818-11 10.766 0 4.763 3.149 8.787 7.521 10.213.55.095.756-.228.756-.51 0-.257-.013-1.104-.013-2.006-2.764.498-3.479-.66-3.699-1.265-.124-.31-.66-1.265-1.128-1.52-.385-.202-.935-.7-.013-.714.866-.013 1.485.78 1.691 1.104.99 1.628 2.571 1.17 3.204.888.096-.7.385-1.17.701-1.44-2.447-.27-5.005-1.198-5.005-5.316 0-1.17.426-2.14 1.128-2.893-.11-.269-.495-1.372.11-2.853 0 0 .92-.282 3.024 1.104.88-.242 1.816-.364 2.75-.364.936 0 1.87.122 2.75.364 2.104-1.4 3.025-1.104 3.025-1.104.605 1.48.22 2.584.11 2.853.702.754 1.128 1.71 1.128 2.893 0 4.132-2.571 5.047-5.019 5.316.399.336.743.982.743 1.992 0 1.44-.014 2.597-.014 2.96 0 .283.206.62.756.511a11.003 11.003 0 0 0 5.426-3.927A10.628 10.628 0 0 0 23 12.368C23 6.42 18.078 1.602 12 1.602z"/>
        </svg>
        <span class="compact">Apoie com uma estrela no GitHub</span>
      </a>
      <div class="btn choose-options" id="color-scheme">
        <select aria-label="Esquema de cores">
          <option value="auto">Auto</option>
          <option value="dark">Escuro</option>
          <option value="light">Claro</option>
        </select>
        <svg
          fill="currentColor"
          viewBox="0 0 20 20"
          role="img"
          class="icon">
          <path d="M10 2a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 2ZM10 15a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 15ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6ZM15.657 5.404a.75.75 0 1 0-1.06-1.06l-1.061 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM6.464 14.596a.75.75 0 1 0-1.06-1.06l-1.06 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM18 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 18 10ZM5 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 5 10ZM14.596 15.657a.75.75 0 0 0 1.06-1.06l-1.06-1.061a.75.75 0 1 0-1.06 1.06l1.06 1.06ZM5.404 6.464a.75.75 0 0 0 1.06-1.06l-1.06-1.06a.75.75 0 1 0-1.061 1.06l1.06 1.06Z"/>
        </svg>
      </div>

      <div class="btn choose-options" id="language-switcher">
        <select aria-label="Troca de idioma">
          <option value="en">English</option>
          <option value="pt">Português</option>
        </select>
        <svg
          fill="none"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          viewBox="0 0 24 24"
          class="icon">
          <path d="m5.636 8.364 5.455 5.454m-6.364 0 5.455-5.454L12 5.636m-9.09 0h10.908M7.455 2.91h.909M21.09 21.091 16.545 12 12 21.09m1.818-3.635h5.455"/>
        </svg>
      </div>
    </div>
  </header>

  <button id="menu-toggle" class="btn" aria-label="Display/Hide menu">
    <svg fill="currentColor" viewBox="0 0 24 24" role="img" class="icon">
      <path d="M21 6H3V5h18v1zm0 5H3v1h18v-1zm0 6H3v1h18v-1z"/>
    </svg>
    <!-- <svg fill="currentColor" viewBox="0 0 24 24" role="img" class="icon">
      <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
    </svg> -->
  </button>

  <nav id="menu" tabindex="-1">
  <div>
    <a href="/pt/docs/">Começando</a>
    <dl>
      <dt>Servidores web</dt>
      <!-- <dd><a href="/pt/docs/web-servers/apache.html">Apache</a></dd> -->
      <dd><a href="/pt/docs/web-servers/nginx.html">nginx</a></dd>
      <dd><a href="/pt/docs/web-servers/iis.html">IIS</a></dd>
      <dd><a href="/pt/docs/web-servers/iis-express.html">IIS Express</a></dd>
    </dl>
    <a href="/pt/docs/structure.html">Estrutura</a>
    <a href="/pt/docs/routing/">Rotas</a>
    <dl>
      <dt>Recursos de rotas</dt>
      <dd><a href="/pt/docs/routing/implicit-route-controllers.html">Controladores de rota implícitos</a></dd>
      <dd><a href="/pt/docs/routing/resource.html">Rotas de recursos</a></dd>
    </dl>
    <a href="/pt/docs/controllers.html">Controladores</a>
    <a href="/pt/docs/views.html">Views</a>
    <a href="/pt/docs/configurations.html">Configurações</a>
    <a href="/pt/docs/debugging.html">Depuração</a>
    <a href="/pt/docs/maintenance.html">Manutenção</a>
    <a href="/pt/docs/error-pages.html">Páginas de erro</a>
    <a href="/pt/docs/console-commands.html">Comandos do console</a>
    <a href="/pt/docs/events.html">Eventos</a>
    <a href="/pt/docs/checkup.html">Checkup</a>
    <a href="/pt/docs/http/request.html">Requisição HTTP</a>
    <a href="/pt/docs/http/response.html">Resposta HTTP</a>
    <dl>
      <dt>Recursos HTTP</dt>
      <dd><a href="/pt/docs/http/content-negotiation.html">Negociação de Conteúdo</a></dd>
      <dd><a href="/pt/docs/http/response-codes.html">Códigos de resposta</a></dd>
    </dl>
    <!-- <a href="/pt/docs/storage-and-files.html">Storage and Files</a> -->
    <!-- <a href="/pt/docs/cache.html">Cache</a> -->
    <a href="/pt/docs/dom/">DOM, XML, HTML</a>
    <dl>
      <dt>Recursos DOM</dt>
      <dd><a href="/pt/docs/dom/css-selector.html">Seletores CSS em PHP</a></dd>
      <dd><a href="/pt/docs/dom/dom-with-arrays.html">DOM com Arrays</a></dd>
      <dd><a href="/pt/docs/dom/errors.html">Erros DOM</a></dd>
    </dl>
    <a href="/pt/docs/utilities/">Utilitários</a>
    <dl>
      <dt>Utilitários específicos</dt>
      <dd><a href="/pt/docs/utilities/url.html">URLs</a></dd>
      <dd><a href="/pt/docs/utilities/version.html">Versão</a></dd>
    </dl>
    <a href="/pt/docs/experimental/">Experimental</a>
    <!-- <a href="/pt/docs/performance.html">Performance</a> -->
    <dl>
      <dt>Produção</dt>
      <!-- <dd><a href="/pt/docs/production/forwarded.html">Forwarded</a></dd> -->
      <dd><a href="/pt/docs/production/sendfile.html">Sendfile</a></dd>
    </dl>
    <dl>
      <dt>Pacotes</dt>
      <dd><a href="/pt/docs/packages/inphinit-proxy.html">Inphinit Proxy</a></dd>
    </dl>
  </div>
  </nav>

  <div id="menu-backdrop"></div>
  <div class="grid-ani"></div>
</body>
</html>
