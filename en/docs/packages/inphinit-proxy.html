<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inphinit Proxy - Inphinit PHP</title>
  <meta name="description" content="Inphinit Proxy is a proxy library intended for use with html2canvas or similar client-side tools that require bypassing CORS restrictions">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">
  <link rel="stylesheet" type="text/css" href="/css/docs.1765824877.css" media="all">
  <link rel="alternate" href="/en/docs/packages/inphinit-proxy.html" hreflang="en">
  <link rel="alternate" href="/pt/docs/packages/inphinit-proxy.html" hreflang="pt">
  <script src="/js/docs.1765824877.js"></script>
</head>
<body>
  <div id="container">
    <main>
      <h1>Inphinit Proxy</h1>

      <p>
      Inphinit Proxy is a proxy library intended for use with html2canvas or similar client-side tools that require bypassing CORS restrictions.
      </p>

      <p>
      Although developed as part of the Inphinit framework, this library is fully standalone and compatible with any framework â€” or even plain PHP.
      </p>

      <section>
        <h2 id="system-requirements"><a href="#system-requirements">System requirements</a></h2>

        <ul>
          <li>cURL PHP extension to use the CurlDriver</li>
          <li><code>allow_url_fopen</code> must be set to <code>1</code> on <code>php.ini</code> to use <code>StreamDriver</code></li>
          <li>Composer (Optional)</li>
        </ul>
      </section>

      <section>
        <h2 id="installing"><a href="#installing">Installing</a></h2>

        <p>You can install via composer:</p>

        <div class="box">
          <code data-lang="terminal" tabindex="0">composer require inphinit/proxy</code>
        </div>

        <p>
          If you're not using a framework, you can download the release from <a rel="external" href="https://github.com/inphinit/inphinit-php-proxy/archive/refs/tags/2.0.0-rc.2.zip">https://github.com/inphinit/inphinit-php-proxy/archive/refs/tags/2.0.0-rc.2.zip</a>, then extract it, move it to your web server, and optionally rename the folder, for example
        </p>

        <div class="box">
          <code data-lang="terminal" tabindex="0">mv "inphinit-php-proxy-2.0.0-rc.2" proxy</code>
        </div>
      </section>

      <section>
        <h2 id="using"><a href="#using">How to use</a></h2>

        <p>Then include this in your script or controller:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Proxy\Proxy;
          use Inphinit\Proxy\Drivers\CurlDriver;
          use Inphinit\Proxy\Drivers\StreamDriver;

          $proxy = new Proxy();

          // Set drivers used for download
          $proxy-&gt;setDrivers([
              CurlDriver::class,
              StreamDriver::class
          ]);

          try {
              // Execute download
              $proxy-&gt;download($_GET['url']);

              // Display raw output
              $proxy-&gt;response();
          } catch (Exception $ee) {
              $code = $ee->getCode();
              $message = $ee->getMessage();

              echo 'Error: (', $code, ') ', $message;
          }
          </code>
        </div>

        <p>Without autoload and composer-autoload is needed manualy include classes:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          use Inphinit\Proxy\Proxy;
          use Inphinit\Proxy\Drivers\CurlDriver;
          use Inphinit\Proxy\Drivers\StreamDriver;

          require_once '/path/proxy/src/CurlDriver.php';
          require_once '/path/proxy/src/StreamDriver.php';
          require_once '/path/proxy/src/Proxy.php';

          $proxy = new Proxy();

          ...
          </code>
        </div>

        <p>To return the download response directly to the browser, use the Proxy::response() method:</p>

        <div class="box">
        <code data-lang="php" tabindex="0">
        use Inphinit\Proxy\Proxy;
        use Inphinit\Proxy\Drivers\CurlDriver;
        use Inphinit\Proxy\Drivers\StreamDriver;

        $proxy = new Proxy();

        $proxy->setDrivers([
            CurlDriver::class,
            StreamDriver::class
        ]);

        $proxy->download($url);

        $proxy->response();
        </code>
        </div>

        <p>If you want to use the JSONP format, replace the <code>Proxy::response()</code> method with <code>Proxy::jsonp()</code>. In this example, the callback will return and receive the content in DATA URI format:</p>

        <div class="box">
        <code data-lang="php" tabindex="0">
        use Inphinit\Proxy\Proxy;
        use Inphinit\Proxy\Drivers\CurlDriver;
        use Inphinit\Proxy\Drivers\StreamDriver;

        if (empty($_GET['callback'])) {
            http_response_code(400);
            die('Missing callback');
        }

        $proxy = new Proxy();

        $proxy->setDrivers([
            CurlDriver::class,
            StreamDriver::class
        ]);

        try {
            $proxy->download($url);
            $proxy->jsonp($_GET['callback']);
        } catch (Exception $ee) {
        }
        </code>
        </div>

        <p>If you need to handle content, you can use the <code>Proxy::getContents()</code>, <code>Proxy::getContentType()</code>, <code>Proxy::getHttpStatus()</code> methods:</p>

        <div class="box">
        <code data-lang="php" tabindex="0">
        use Inphinit\Proxy\Proxy;
        use Inphinit\Proxy\Drivers\CurlDriver;
        use Inphinit\Proxy\Drivers\StreamDriver;

        $proxy = new Proxy();

        $proxy->setDrivers([
            CurlDriver::class,
            StreamDriver::class
        ]);

        try {
            $proxy->download($url);

            // Success
            $contents = $proxy->getContents();
            $contentType = $proxy->getContentType();
            $httpStatus = $proxy->getHttpStatus();

            ...

        } catch (Exception $ee) {
            $code = $ee->getCode();
            $message = $ee->getMessage();

            echo 'Error: (', $code, ') ', $message;
        }
        </code>
        </div>

        <p>In the examples so far, <code>CurlDriver</code> takes priority, and uses <code>StreamDriver</code> as a fallback, but you can change this, in a hypothetical example, if you only want to use <code>StreamDriver</code>:</p>

        <div class="box">
        <code data-lang="php" tabindex="0">
        $proxy->setDrivers([
            StreamDriver::class
        ]);
        </code>
        </div>

        You can also limit the URLs that the proxy can access:

        <div class="box">
        <code data-lang="php" tabindex="0">
        $proxy->setAllowedUrls([
            'https://domain1.com/',        // Allows requests on any path to https://domain1.com
            'https://domain2.com/images/', // Allows requests from the path /images/ on https://domain2.com
            'https://*.mainsite.io/',      // Allows requests on subdomains of mainsite.io
            'https://foo.io:8000/',        // Allows requests to foo.io with port 8000
            '*://other.io/',               // Allows HTTPS and HTTP requests to other.io
        ]);

        $proxy->download($url);
        </code>
        </div>
      </section>

      <section>
        <p>
          Generic options allow you to customize driver behavior through their native configuration mechanisms (cURL options or stream contexts). Since each driver may require different types of settings, the most flexible approach is to allow these options to store any value. This is particularly useful when developing a new driver.
        </p>

        <p>To configure the cURL driver, use <code>'curl'</code> as the first parameter, for example <code>$proxy->setOptions('curl', [ ... ])</code>, an example to change the SSL version:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $proxy->setOptions('curl', [
              CURLOPT_SSLVERSION => CURL_SSLVERSION_TLSv1_3
          ]);
          </code>
        </div>

        <p>An example to disable SSL verification (for local testing, don't use in a production environment):</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $proxy->setOptions('curl', [
              CURLOPT_SSL_VERIFYHOST => 0,
              CURLOPT_SSL_VERIFYPEER => false
          ]);
          </code>
        </div>

        <p>
          For more constants options to be used with <code>$proxy->setOptions('curl', [ ... ])</code>, see: <a rel="external nofollow noreferrer" target="_blank" href="https://www.php.net/manual/en/curl.constants.php">https://www.php.net/manual/en/curl.constants.php</a>
        </p>

        <p>
          To configure the <code>StreamDriver</code>, use <code>'stream'</code> as the first parameter in <code>setOptions()</code>,
          an example to set the HTTP protocol version:
        </p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $proxy->setOptions('stream', [
              'http' => [
                  'protocol_version' => 1.0,
              ]
          ]);
          </code>
        </div>

        <p>Example SSL configuration:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $proxy->setOptions('stream', [
              'ssl' => [
                  'verify_peer'   => true,
                  'cafile'        => '/foo/bar/baz/cacert.pem',
                  'verify_depth'  => 5,
                  'CN_match'      => 'secure.example.com'
              ]
          ]);
          </code>
        </div>
      </section>

      <section>
        <h2 id="content-type-allowed"><a href="#content-type-allowed">Content-Type allowed</a></h2>

        <p>When executing the <code>download()</code> method, a Content-Type validation will be performed, by default the following Content-Types are allowed:</p>

        <div class="box">
        <table>
        <thead>
        <tr>
        <th><code>Content-Type</code></th>
        <th><code>Proxy::jsonp()</code></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><code>image/apng</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/png</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/avif</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/webp</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/gif</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/jpeg</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/svg+xml</code></td>
        <td>URL-encoded</td>
        </tr>
        <tr>
        <td><code>image/svg-xml</code></td>
        <td>URL-encoded</td>
        </tr>
        </tbody>
        </table>
        </div>

        <p>You can define additional allowed Content-Types, for example:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $proxy->addAllowedType('image/x-icon', true);
          $proxy->addAllowedType('image/vnd.microsoft.icon', true);
          </code>
        </div>

        <p>The method's second parameter specifies whether <code>Proxy::jsonp()</code> should use URL encoding or Base64 encoding in the data URI scheme.</p>

        <p>To remove an allowed Content-Type use the <code>Proxy::removeAllowedType()</code> method, example:</p>

        <div class="box">
          <code data-lang="php" tabindex="0">
          $proxy->removeAllowedType('image/apng');
          </code>
        </div>
      </section>

      <section>
        <h2 id="api"><a href="#api">API</a></h2>

        <div class="box">
        <table>
        <thead>
        <tr>
        <th>Method</th>
        <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><code>setMaxDownloadSize(int $value): void</code></td>
        <td>Set the maximum allowed download size</td>
        </tr>
        <tr>
        <td><code>getMaxDownloadSize(): int</code></td>
        <td>Get the maximum allowed download size</td>
        </tr>
        <tr>
        <td><code>setMaxRedirs(int $value): void</code></td>
        <td>Set the maximum number of HTTP redirects</td>
        </tr>
        <tr>
        <td><code>getMaxRedirs(): int</code></td>
        <td>Get the maximum number of HTTP redirects</td>
        </tr>
        <tr>
        <td><code>setReferer(string $value): void</code></td>
        <td>Set the <code>Referer:</code> request header</td>
        </tr>
        <tr>
        <td><code>getReferer(): string</code></td>
        <td>Get the <code>Referer:</code> request header</td>
        </tr>
        <tr>
        <td><code>setTimeout(int $value): void</code></td>
        <td>Set the connection timeout in seconds</td>
        </tr>
        <tr>
        <td><code>getTimeout(): int</code></td>
        <td>Get the connection timeout in seconds</td>
        </tr>
        <tr>
        <td><code>setUserAgent(string $value): void</code></td>
        <td>Set the <code>User-Agent:</code> request header</td>
        </tr>
        <tr>
        <td><code>getUserAgent(): string</code></td>
        <td>Get the <code>User-Agent:</code> request header</td>
        </tr>
        <tr>
        <td><code>setDrivers(array $drivers): void</code></td>
        <td>Set the list of driver class names used for downloading resources</td>
        </tr>
        <tr>
        <td><code>setControlAllowOrigin(string $origin): void</code></td>
        <td>Set the <code>Access-Control-Allow-Origin:</code> header</td>
        </tr>
        <tr>
        <td><code>setControlAllowHeaders(array $headers): void</code></td>
        <td>Set the list of allowed headers</td>
        </tr>
        <tr>
        <td><code>setOptions(string $key, mixed $value): void</code></td>
        <td>Set generic options</td>
        </tr>
        <tr>
        <td><code>getOptions([string $key]): mixed</code></td>
        <td>Get generic options</td>
        </tr>
        <tr>
        <td><code>getOptionsUpdate(): int</code></td>
        <td>Returns an internal incremental counter used to determine whether driver options have changed</td>
        </tr>
        <tr>
        <td><code>setAllowedUrls(array $urls): void</code></td>
        <td>Set the list of allowed URLs for download</td>
        </tr>
        <tr>
        <td><code>addAllowedType(string $type, bool $binary): void</code></td>
        <td>Add a <code>Content-Type</code> to the allowed list, <code>true</code> = Base64 encoding, <code>false</code> = URL encoding</td>
        </tr>
        <tr>
        <td><code>removeAllowedType(string $type): void</code></td>
        <td>Remove a <code>Content-Type</code> from the allowed list</td>
        </tr>
        <tr>
        <td><code>isAllowedType(string $type, string &amp;$errorMessage): bool</code></td>
        <td>Check if a given <code>Content-Type</code> is allowed (this method will be used by drivers)</td>
        </tr>
        <tr>
        <td><code>setTemporary(string $path): void</code></td>
        <td>Set the temporary storage path or stream for downloaded content (e.g., <code>/mnt/storage/</code>, <code>php://temp</code>, <code>php://memory</code>)</td>
        </tr>
        <tr>
        <td><code>getTemporary(): resource|null</code></td>
        <td>Get the temporary stream resource used for downloaded content</td>
        </tr>
        <tr>
        <td><code>download(string $url): void</code></td>
        <td>Perform the download</td>
        </tr>
        <tr>
        <td><code>setResponseCacheTime(int $seconds): void</code></td>
        <td>Set the cache duration (in seconds) or disable cache for <code>Proxy::response()</code> or <code>Proxy::jsonp()</code></td>
        </tr>
        <tr>
        <td><code>response(): void</code></td>
        <td>Dump response to output</td>
        </tr>
        <tr>
        <td><code>jsonp(string $callback): void</code></td>
        <td>Output JSONP callback with URL or data URI content</td>
        </tr>
        <tr>
        <td><code>getContents([int $length[, int $offset]]): string|null</code></td>
        <td>If last download was successful, contents will be returned</td>
        </tr>
        <tr>
        <td><code>getContentType(): string|null</code></td>
        <td>If last download was successful, <code>Content-Type</code> will be returned</td>
        </tr>
        <tr>
        <td><code>getHttpStatus(): int|null</code></td>
        <td>If last download was successful, HTTP status will be returned</td>
        </tr>
        <tr>
        <td><code>reset(): void</code></td>
        <td>Reset last download</td>
        </tr>
        </tbody>
        </table>
        </div>
      </section>
    </main>
    <footer>
      <div>
        <p>Last updated on <time datetime="2025-12-22">Nov 22, 2025</time>.</p>
        <p>Content licensed under CC BY-SA.</p>
      </div>
      <div>
        <p>
          Site design by <a rel="external" target="_blank" href="https://github.com/brcontainer">Brcontainer</a>
        </p>
      </div>
    </footer>
  </div>

  <header>
    <a href="/">Go to homepage</a>
    <div>
      <!--
      <form method="get" id="search" action="http://duckduckgo.com/">
        <input type="hidden" name="sites" value="inphinit.github.io"/>
        <input type="hidden" name="k8" value="#444444"/>
        <input type="hidden" name="k9" value="#D51920"/>
        <input type="hidden" name="kt" value="h"/>
        <input type="text" name="q" maxlength="255" placeholder="Search&hellip;"/>
        <input type="submit" value="DuckDuckGo Search" style="visibility: hidden;" />
      </form>
      -->
      <a
        href="https://github.com/inphinit/inphinit"
        rel="external"
        target="_blank"
        aria-label="Access Github for get source">
        <svg
          fill="currentColor"
          viewBox="0 0 24 24"
          role="img"
          class="icon">
          <path d="M12 1.602c-6.077 0-11 4.818-11 10.766 0 4.763 3.149 8.787 7.521 10.213.55.095.756-.228.756-.51 0-.257-.013-1.104-.013-2.006-2.764.498-3.479-.66-3.699-1.265-.124-.31-.66-1.265-1.128-1.52-.385-.202-.935-.7-.013-.714.866-.013 1.485.78 1.691 1.104.99 1.628 2.571 1.17 3.204.888.096-.7.385-1.17.701-1.44-2.447-.27-5.005-1.198-5.005-5.316 0-1.17.426-2.14 1.128-2.893-.11-.269-.495-1.372.11-2.853 0 0 .92-.282 3.024 1.104.88-.242 1.816-.364 2.75-.364.936 0 1.87.122 2.75.364 2.104-1.4 3.025-1.104 3.025-1.104.605 1.48.22 2.584.11 2.853.702.754 1.128 1.71 1.128 2.893 0 4.132-2.571 5.047-5.019 5.316.399.336.743.982.743 1.992 0 1.44-.014 2.597-.014 2.96 0 .283.206.62.756.511a11.003 11.003 0 0 0 5.426-3.927A10.628 10.628 0 0 0 23 12.368C23 6.42 18.078 1.602 12 1.602z"/>
        </svg>
        <span class="compact">Star us on Github</span>
      </a>
      <div class="btn" id="color-scheme">
        <select aria-label="Color Scheme">
          <option>Auto</option>
          <option>Dark</option>
          <option>Light</option>
        </select>
        <svg
          fill="currentColor"
          viewBox="0 0 20 20"
          role="img"
          class="icon">
          <path d="M10 2a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 2ZM10 15a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 15ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6ZM15.657 5.404a.75.75 0 1 0-1.06-1.06l-1.061 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM6.464 14.596a.75.75 0 1 0-1.06-1.06l-1.06 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM18 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 18 10ZM5 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 5 10ZM14.596 15.657a.75.75 0 0 0 1.06-1.06l-1.06-1.061a.75.75 0 1 0-1.06 1.06l1.06 1.06ZM5.404 6.464a.75.75 0 0 0 1.06-1.06l-1.06-1.06a.75.75 0 1 0-1.061 1.06l1.06 1.06Z"/>
        </svg>
      </div>
    </div>
  </header>

  <button id="menu-toggle" class="btn" aria-label="Display/Hide menu">
    <svg fill="currentColor" viewBox="0 0 24 24" role="img" class="icon">
      <path d="M21 6H3V5h18v1zm0 5H3v1h18v-1zm0 6H3v1h18v-1z"/>
    </svg>
    <!-- <svg fill="currentColor" viewBox="0 0 24 24" role="img" class="icon">
      <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
    </svg> -->
  </button>

  <nav id="menu" tabindex="-1">
  <div>
    <a href="/en/docs/">Get started</a>
    <dl>
      <dt>Web server</dt>
      <!-- <dd><a href="/en/docs/web-server/apache.html">Apache</a></dd> -->
      <dd><a href="/en/docs/web-server/nginx.html">nginx</a></dd>
      <dd><a href="/en/docs/web-server/iis.html">IIS</a></dd>
      <dd><a href="/en/docs/web-server/iis-express.html">IIS Express</a></dd>
    </dl>
    <a href="/en/docs/structure.html">Structure</a>
    <a href="/en/docs/routing/">Routing</a>
    <dl>
      <dt>Routing features</dt>
      <dd><a href="/en/docs/routing/implicit-route-controllers.html">Implicit route controllers</a></dd>
      <dd><a href="/en/docs/routing/resource.html">Resource routes</a></dd>
    </dl>
    <a href="/en/docs/controllers.html">Controllers</a>
    <a href="/en/docs/views.html">Views</a>
    <a href="/en/docs/configurations.html">Configurations</a>
    <a href="/en/docs/debugging.html">Debugging</a>
    <a href="/en/docs/maintenance.html">Maintenance</a>
    <a href="/en/docs/error-pages.html">Error Pages</a>
    <a href="/en/docs/console-commands.html">Console Commands</a>
    <a href="/en/docs/events.html">Events</a>
    <a href="/en/docs/checkup.html">Checkup</a>
    <a href="/en/docs/http/request.html">HTTP Request</a>
    <a href="/en/docs/http/response.html">HTTP Response</a>
    <dl>
      <dt>HTTP feautures</dt>
      <dd><a href="/en/docs/http/content-negotiation.html">Content Negotiation</a></dd>
      <dd><a href="/en/docs/http/response-codes.html">Response Codes</a></dd>
    </dl>
    <!-- <a href="/en/docs/storage-and-files.html">Storage and Files</a> -->
    <!-- <a href="/en/docs/cache.html">Cache</a> -->
    <a href="/en/docs/dom/">DOM, XML, HTML</a>
    <dl>
      <dt>DOM feautures</dt>
      <dd><a href="/en/docs/dom/css-selector.html">CSS Selector in PHP</a></dd>
      <dd><a href="/en/docs/dom/dom-with-arrays.html">DOM with Arrays</a></dd>
      <dd><a href="/en/docs/dom/errors.html">DOM Errors</a></dd>
    </dl>
    <a href="/en/docs/utilities/">Utilities</a>
    <dl>
      <dt>Specific utilities</dt>
      <dd><a href="/en/docs/utilities/url.html">Urls</a></dd>
      <dd><a href="/en/docs/utilities/version.html">Version</a></dd>
    </dl>
    <a href="/en/docs/experimental/">Experimental</a>
    <!-- <a href="/en/docs/performance.html">Performance</a> -->
    <dl>
      <dt>Production</dt>
      <!-- <dd><a href="/en/docs/production/forwarded.html">Forwarded</a></dd> -->
      <dd><a href="/en/docs/production/send-file.html">Send file</a></dd>
    </dl>
    <dl>
      <dt>Packages</dt>
      <dd><a href="/en/docs/packages/inphinit-proxy.html">Inphinit Proxy</a></dd>
    </dl>
  </div>
  </nav>

  <div id="menu-backdrop"></div>
</body>
</html>

