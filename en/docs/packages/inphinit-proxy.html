<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inphinit Proxy - Inphinit PHP</title>
  <meta name="description" content="Inphinit Proxy is a proxy library intended for use with html2canvas or similar client-side tools that require bypassing CORS restrictions">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="/css/docs.1765229583.css" media="all">
  <script src="/js/docs.1765229583.js"></script>
</head>
<body>
  <div id="container">
    <main>
      <h1>Inphinit Proxy</h1>

      <p>
      Inphinit Proxy is a proxy library intended for use with html2canvas or similar client-side tools that require bypassing CORS restrictions.
      </p>

      <p>
      Although developed as part of the Inphinit framework, this library is fully standalone and compatible with any framework â€” or even plain PHP.
      </p>

      <section>
        <h2 id="system-requirements">
          <a href="#system-requirements">System requirements</a>
        </h2>

        <ul>
          <li>cURL PHP extension to use the CurlDriver</li>
          <li>`allow_url_fopen` must be set to `1` on `php.ini` to use StreamDriver</li>
          <li>Composer (Optional)</li>
        </ul>
      </section>

      <section>
        <h2 id="installing">
          <a href="#installing">Installing</a>
        </h2>

        <p>You can install via composer:</p>

        <div class="box">
          <code data-lang="terminal" tabindex="0">composer require inphinit/proxy</code>
        </div>

        <p>
          If you're not using a framework, you can download the release from <a rel="external" href="https://github.com/inphinit/inphinit-php-proxy/archive/refs/tags/2.0.0-rc.2.zip">https://github.com/inphinit/inphinit-php-proxy/archive/refs/tags/2.0.0-rc.2.zip</a>, then extract it, move it to your web server, and optionally rename the folder, for example
        </p>

        <div class="box">
          <code data-lang="terminal" tabindex="0">mv "inphinit-php-proxy-2.0.0-rc.2" proxy</code>
        </div>
      </section>

      <section>
        <h2 id="using">
          <a href="#using">How to use</a>
        </h2>

        <p>Then include this in your script or controller:</p>

        <div class="box">
          <code data-lang="php">
          use Inphinit\Proxy\Proxy;
          use Inphinit\Proxy\Drivers\CurlDriver;
          use Inphinit\Proxy\Drivers\StreamDriver;

          $proxy = new Proxy();

          // Set drivers used for download
          $proxy-&gt;setDrivers([
              CurlDriver::class,
              StreamDriver::class
          ]);

          try {
              // Execute download
              $proxy-&gt;download($_GET['url']);

              // Display raw output
              $proxy-&gt;response();
          } catch (Exception $ee) {
              $code = $ee->getCode();
              $message = $ee->getMessage();

              echo 'Error: (', $code, ') ', $message;
          }
          </code>
        </div>

        <p>Without autoload and composer-autoload is needed manualy include classes:</p>

        <div class="box">
          <code data-lang="php">
          use Inphinit\Proxy\Proxy;
          use Inphinit\Proxy\Drivers\CurlDriver;
          use Inphinit\Proxy\Drivers\StreamDriver;

          require_once '/path/proxy/src/CurlDriver.php';
          require_once '/path/proxy/src/StreamDriver.php';
          require_once '/path/proxy/src/Proxy.php';

          $proxy = new Proxy();

          ...
          </code>
        </div>

        <p>To return the download response directly to the browser, use the Proxy::response() method:</p>

        <div class="box">
        <code data-lang="php">
        use Inphinit\Proxy\Proxy;
        use Inphinit\Proxy\Drivers\CurlDriver;
        use Inphinit\Proxy\Drivers\StreamDriver;

        $proxy = new Proxy();

        $proxy->setDrivers([
            CurlDriver::class,
            StreamDriver::class
        ]);

        $proxy->download($url);

        $proxy->response();

        If you want to use the JSONP format, replace the Proxy::response method with Proxy::jsonp(). In this example, the callback will return and receive the content in DATA URI format:

        use Inphinit\Proxy\Proxy;
        use Inphinit\Proxy\Drivers\CurlDriver;
        use Inphinit\Proxy\Drivers\StreamDriver;

        if (empty($_GET['callback'])) {
            http_response_code(400);
            die('Missing callback');
        }

        $proxy = new Proxy();

        $proxy->setDrivers([
            CurlDriver::class,
            StreamDriver::class
        ]);

        try {
            $proxy->download($url);
            $proxy->jsonp($_GET['callback']);
        } catch (Exception $ee) {
        }
        </code>
        </div>

        If you need to handle content, you can use the Proxy::getContents(), Proxy::getContentType(), Proxy::getHttpStatus() methods:

        <div class="box">
        <code data-lang="php">
        use Inphinit\Proxy\Proxy;
        use Inphinit\Proxy\Drivers\CurlDriver;
        use Inphinit\Proxy\Drivers\StreamDriver;

        $proxy = new Proxy();

        $proxy->setDrivers([
            CurlDriver::class,
            StreamDriver::class
        ]);

        try {
            $proxy->download($url);

            // Success
            $contents = $proxy->getContents();
            $contentType = $proxy->getContentType();
            $httpStatus = $proxy->getHttpStatus();

            ...

        } catch (Exception $ee) {
            $code = $ee->getCode();
            $message = $ee->getMessage();

            echo 'Error: (', $code, ') ', $message;
        }
        </code>
        </div>

        In the examples so far, CurlDriver takes priority, and uses StreamDriver as a fallback, but you can change this, in a hypothetical example, if you only want to use StreamDriver:

        <div class="box">
        <code data-lang="php">
        $proxy->setDrivers([
            StreamDriver::class
        ]);
        </code>
        </div>

        You can also limit the URLs that the proxy can access:

        <div class="box">
        <code data-lang="php">
        $proxy->setAllowedUrls([
            'https://domain1.com/',        // Allows requests on any path to https://domain1.com
            'https://domain2.com/images/', // Allows requests from the path /images/ on https://domain2.com
            'https://*.mainsite.io/',      // Allows requests on subdomains of mainsite.io
            'https://foo.io:8000/',        // Allows requests to foo.io with port 8000
            '*://other.io/',               // Allows HTTPS and HTTP requests to other.io
        ]);

        $proxy->download($url);
        </code>
        </div>
      </section>

      <section>
        <p>Generic options allow you to customize driver behavior through their native configuration mechanisms (cURL options or stream contexts). Since each driver may require different types of settings, the most flexible approach is to allow these options to store any value. This is particularly useful when developing a new driver.</p>

        <p>To configure the cURL driver, use 'curl' as the first parameter, for example $proxy->setOptions('curl', [ ... ]);, an example to change the SSL version:</p>

        <div class="box">
          <code data-lang="php">
          $proxy->setOptions('curl', [
              CURLOPT_SSLVERSION => CURL_SSLVERSION_TLSv1_3
          ]);
          </code>
        </div>

        <p>An example to disable SSL verification (for local testing, don't use in a production environment):</p>

        <div class="box">
          <code data-lang="php">
          $proxy->setOptions('curl', [
              CURLOPT_SSL_VERIFYHOST => 0,
              CURLOPT_SSL_VERIFYPEER => false
          ]);
          </code>
        </div>

        <p>
          For more constants options to be used with $proxy->setOptions('curl', [ ... ]), see: <a href="https://www.php.net/manual/en/curl.constants.php">https://www.php.net/manual/en/curl.constants.php</a>
        </p>

        <p>To configure the Stream driver, use 'stream' as the first parameter in setOptions(), an example to set the HTTP protocol version:</p>

        <div class="box">
          <code data-lang="php">
          $proxy->setOptions('stream', [
              'http' => [
                  'protocol_version' => 1.0,
              ]
          ]);
          </code>
        </div>

        Example SSL configuration:

        <div class="box">
          <code data-lang="php">
          $proxy->setOptions('stream', [
              'ssl' => [
                  'verify_peer'   => true,
                  'cafile'        => '/foo/bar/baz/cacert.pem',
                  'verify_depth'  => 5,
                  'CN_match'      => 'secure.example.com'
              ]
          ]);
          </code>
        </div>
      </section>

      <section>
        <h2 id="content-type-allowed">
          <a href="#content-type-allowed">Content-Type allowed</a>
        </h2>

        <p>When executing the download() method, a Content-Type validation will be performed, by default the following Content-Types are allowed:</p>

        <div class="box">
        <table>
        <thead>
        <tr>
        <th><code>Content-Type</code></th>
        <th><code>Proxy::jsonp()</code></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><code>image/apng</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/png</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/avif</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/webp</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/gif</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/jpeg</code></td>
        <td>base64</td>
        </tr>
        <tr>
        <td><code>image/svg+xml</code></td>
        <td>URL-encoded</td>
        </tr>
        <tr>
        <td><code>image/svg-xml</code></td>
        <td>URL-encoded</td>
        </tr>
        </tbody>
        </table>
        </div>

        You can define additional allowed Content-Types, for example:

        <div class="box">
          <code data-lang="php">
          $proxy->addAllowedType('image/x-icon', true);
          $proxy->addAllowedType('image/vnd.microsoft.icon', true);
          </code>
        </div>

        The method's second parameter specifies whether Proxy::jsonp() should use URL encoding or Base64 encoding in the data URI scheme.

        To remove an allowed Content-Type use the Proxy::removeAllowedType() method, example:

        <div class="box">
          <code data-lang="php">
          $proxy->removeAllowedType('image/apng');
          </code>
        </div>
      </section>

      <section>
        <h2 id="api">
          <a href="#api">API</a>
        </h2>

        <div class="box">
        <table>
        <thead>
        <tr>
        <th>Method</th>
        <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><code>setMaxDownloadSize(int $value): void</code></td>
        <td>Set the maximum allowed download size</td>
        </tr>
        <tr>
        <td><code>getMaxDownloadSize(): int</code></td>
        <td>Get the maximum allowed download size</td>
        </tr>
        <tr>
        <td><code>setMaxRedirs(int $value): void</code></td>
        <td>Set the maximum number of HTTP redirects</td>
        </tr>
        <tr>
        <td><code>getMaxRedirs(): int</code></td>
        <td>Get the maximum number of HTTP redirects</td>
        </tr>
        <tr>
        <td><code>setReferer(string $value): void</code></td>
        <td>Set the <code>Referer</code> request header</td>
        </tr>
        <tr>
        <td><code>getReferer(): string</code></td>
        <td>Get the <code>Referer</code> request header</td>
        </tr>
        <tr>
        <td><code>setTimeout(int $value): void</code></td>
        <td>Set the connection timeout in seconds</td>
        </tr>
        <tr>
        <td><code>getTimeout(): int</code></td>
        <td>Get the connection timeout in seconds</td>
        </tr>
        <tr>
        <td><code>setUserAgent(string $value): void</code></td>
        <td>Set the <code>User-Agent</code> request header</td>
        </tr>
        <tr>
        <td><code>getUserAgent(): string</code></td>
        <td>Get the <code>User-Agent</code> request header</td>
        </tr>
        <tr>
        <td><code>setDrivers(array $drivers): void</code></td>
        <td>Set the list of driver class names used for downloading resources</td>
        </tr>
        <tr>
        <td><code>setControlAllowOrigin(string $origin): void</code></td>
        <td>Set the <code>Access-Control-Allow-Origin</code> header</td>
        </tr>
        <tr>
        <td><code>setControlAllowHeaders(array $headers): void</code></td>
        <td>Set the list of allowed headers</td>
        </tr>
        <tr>
        <td><code>setOptions(string $key, mixed $value): void</code></td>
        <td>Set generic options</td>
        </tr>
        <tr>
        <td><code>getOptions([string $key]): mixed</code></td>
        <td>Get generic options</td>
        </tr>
        <tr>
        <td><code>getOptionsUpdate(): int</code></td>
        <td>Returns an internal incremental counter used to determine whether driver options have changed</td>
        </tr>
        <tr>
        <td><code>setAllowedUrls(array $urls): void</code></td>
        <td>Set the list of allowed URLs for download</td>
        </tr>
        <tr>
        <td><code>addAllowedType(string $type, bool $binary): void</code></td>
        <td>Add a <code>Content-Type</code> to the allowed list, <code>true</code> = Base64 encoding, <code>false</code> = URL encoding</td>
        </tr>
        <tr>
        <td><code>removeAllowedType(string $type): void</code></td>
        <td>Remove a <code>Content-Type</code> from the allowed list</td>
        </tr>
        <tr>
        <td><code>isAllowedType(string $type, string &amp;$errorMessage): bool</code></td>
        <td>Check if a given <code>Content-Type</code> is allowed (this method will be used by drivers)</td>
        </tr>
        <tr>
        <td><code>setTemporary(string $path): void</code></td>
        <td>Set the temporary storage path or stream for downloaded content (e.g., <code>/mnt/storage/</code>, <code>php://temp</code>, <code>php://memory</code>).</td>
        </tr>
        <tr>
        <td><code>getTemporary(): resource|null</code></td>
        <td>Get the temporary stream resource used for downloaded content</td>
        </tr>
        <tr>
        <td><code>download(string $url): void</code></td>
        <td>Perform the download</td>
        </tr>
        <tr>
        <td><code>setResponseCacheTime(int $seconds): void</code></td>
        <td>Set the cache duration (in seconds) or disable cache for <code>Proxy::response()</code> or <code>Proxy::jsonp()</code></td>
        </tr>
        <tr>
        <td><code>response(): void</code></td>
        <td>Dump response to output</td>
        </tr>
        <tr>
        <td><code>jsonp(string $callback): void</code></td>
        <td>Output JSONP callback with URL or data URI content</td>
        </tr>
        <tr>
        <td><code>getContents([int $length[, int $offset]]): string|null</code></td>
        <td>If last download was successful, contents will be returned</td>
        </tr>
        <tr>
        <td><code>getContentType(): string|null</code></td>
        <td>If last download was successful, <code>Content-Type</code> will be returned</td>
        </tr>
        <tr>
        <td><code>getHttpStatus(): int|null</code></td>
        <td>If last download was successful, HTTP status will be returned</td>
        </tr>
        <tr>
        <td><code>reset(): void</code></td>
        <td>Reset last download</td>
        </tr>
        </tbody>
        </table>
        </div>
      </section>
    </main>
    <footer>
      <div>
        <p>Last updated on <time datetime="2025-11-11">Nov 11, 2025</time>.</p>
        <p>Content licensed under CC BY-SA.</p>
      </div>
      <div>
        <p>
          Site design by <a href="https://github.com/brcontainer" rel="external" target="_blank">Brcontainer</a>
        </p>
      </div>
    </footer>
  </div>

  <header>
    <a href="/">Go to homepage</a>
    <div>
      <!--
      <form method="get" id="search" action="http://duckduckgo.com/">
        <input type="hidden" name="sites" value="inphinit.github.io"/>
        <input type="hidden" name="k8" value="#444444"/>
        <input type="hidden" name="k9" value="#D51920"/>
        <input type="hidden" name="kt" value="h"/>
        <input type="text" name="q" maxlength="255" placeholder="Search&hellip;"/>
        <input type="submit" value="DuckDuckGo Search" style="visibility: hidden;" />
      </form>
      -->
      <a
        href="https://github.com/inphinit/inphinit"
        rel="external"
        target="_blank"
        aria-label="Access Github for get source">
        <svg
          fill="currentColor"
          viewBox="0 0 24 24"
          role="img"
          class="icon">
          <path d="M12 1.60205C5.9225 1.60205 1 6.41965 1 12.3676C1 17.1314 4.14875 21.155 8.52125 22.5815C9.07125 22.6757 9.2775 22.3527 9.2775 22.0701C9.2775 21.8144 9.26375 20.9666 9.26375 20.065C6.5 20.5629 5.785 19.4056 5.565 18.8001C5.44125 18.4906 4.905 17.5351 4.4375 17.2794C4.0525 17.0776 3.5025 16.5797 4.42375 16.5662C5.29 16.5528 5.90875 17.3467 6.115 17.6697C7.105 19.298 8.68625 18.8404 9.31875 18.5578C9.415 17.8581 9.70375 17.3871 10.02 17.1179C7.5725 16.8488 5.015 15.9203 5.015 11.8024C5.015 10.6317 5.44125 9.66278 6.1425 8.90919C6.0325 8.64005 5.6475 7.53658 6.2525 6.05631C6.2525 6.05631 7.17375 5.77372 9.2775 7.15978C10.1575 6.91756 11.0925 6.79645 12.0275 6.79645C12.9625 6.79645 13.8975 6.91756 14.7775 7.15978C16.8813 5.76026 17.8025 6.05631 17.8025 6.05631C18.4075 7.53658 18.0225 8.64005 17.9125 8.90919C18.6138 9.66278 19.04 10.6182 19.04 11.8024C19.04 15.9337 16.4688 16.8488 14.0213 17.1179C14.42 17.4544 14.7638 18.1003 14.7638 19.1096C14.7638 20.5495 14.75 21.7068 14.75 22.0701C14.75 22.3527 14.9563 22.6891 15.5063 22.5815C17.69 21.86 19.5875 20.4865 20.9318 18.6542C22.2761 16.822 22.9994 14.6233 23 12.3676C23 6.41965 18.0775 1.60205 12 1.60205Z"/>
        </svg>
        <span class="compact">Star us on Github</span>
      </a>
      <div class="btn" id="color-scheme">
        <select aria-label="Color Scheme">
          <option>Auto</option>
          <option>Dark</option>
          <option>Light</option>
        </select>
        <svg
          fill="currentColor"
          viewBox="0 0 20 20"
          role="img"
          class="icon">
          <path d="M10 2a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 2ZM10 15a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 15ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6ZM15.657 5.404a.75.75 0 1 0-1.06-1.06l-1.061 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM6.464 14.596a.75.75 0 1 0-1.06-1.06l-1.06 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM18 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 18 10ZM5 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 5 10ZM14.596 15.657a.75.75 0 0 0 1.06-1.06l-1.06-1.061a.75.75 0 1 0-1.06 1.06l1.06 1.06ZM5.404 6.464a.75.75 0 0 0 1.06-1.06l-1.06-1.06a.75.75 0 1 0-1.061 1.06l1.06 1.06Z"/>
        </svg>
      </div>
      <button id="menu-toggle" class="btn" aria-label="Display/Hide menu">
        <svg fill="currentColor" viewBox="0 0 24 24" role="img" class="icon">
          <path d="M21 6H3V5h18v1zm0 5H3v1h18v-1zm0 6H3v1h18v-1z"/>
        </svg>
        <!-- <svg fill="currentColor" viewBox="0 0 24 24" role="img" class="icon">
          <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg> -->
      </button>
    </div>
  </header>

  <nav id="menu" tabindex="-1">
    <a href="/en/docs/">Get started</a>
    <dl>
      <dt>Web server</dt>
      <!-- <dd><a href="/en/docs/web-server/apache.html">Apache</a></dd> -->
      <dd><a href="/en/docs/web-server/nginx.html">nginx</a></dd>
      <dd><a href="/en/docs/web-server/iis.html">IIS</a></dd>
      <dd><a href="/en/docs/web-server/iis-express.html">IIS Express</a></dd>
    </dl>
    <a href="/en/docs/structure.html">Structure</a>
    <a href="/en/docs/configurations.html">Configurations</a>
    <a href="/en/docs/checkup.html">Checkup</a>
    <a href="/en/docs/debugging.html">Debugging</a>
    <a href="/en/docs/routing/">Routing</a>
    <dl>
      <dt>Routing features</dt>
      <dd><a href="/en/docs/routing/implicit-route-controllers.html">Implicit route controllers</a></dd>
      <dd><a href="/en/docs/routing/resource.html">Resource routes</a></dd>
    </dl>
    <a href="/en/docs/controllers.html">Controllers</a>
    <a href="/en/docs/views.html">Views</a>
    <a href="/en/docs/http/request.html">HTTP Request</a>
    <a href="/en/docs/http/response.html">HTTP Response</a>
    <dl>
      <dt>HTTP feautures</dt>
      <dd><a href="/en/docs/http/content-negotiation.html">Content Negotiation</a></dd>
    </dl>
    <!-- <a href="/en/docs/storage-and-files.html">Storage and Files</a> -->
    <!-- <a href="/en/docs/cache.html">Cache</a> -->
    <a href="/en/docs/maintenance.html">Maintenance</a>
    <a href="/en/docs/error-pages.html">Error pages</a>
    <a href="/en/docs/dom/">DOM, XML, HTML</a>
    <dl>
      <dt>DOM feautures</dt>
      <dd><a href="/en/docs/dom/css-selector.html">CSS Selector in PHP</a></dd>
      <dd><a href="/en/docs/dom/dom-with-arrays.html">DOM with Arrays</a></dd>
      <dd><a href="/en/docs/dom/errors.html">DOM Errors</a></dd>
    </dl>
    <dl>
      <dt>Specific utilities</dt>
      <dd><a href="/en/docs/utilities/arrays.html">Arrays</a></dd>
      <dd><a href="/en/docs/utilities/strings.html">Strings</a></dd>
      <dd><a href="/en/docs/utilities/url.html">Urls</a></dd>
      <dd><a href="/en/docs/utilities/version.html">Version</a></dd>
    </dl>
    <a href="/en/docs/console-commands.html">Console Commands</a>
    <a href="/en/docs/events.html">Events</a>
    <a href="/en/docs/experimental/">Experimental</a>
    <!-- <a href="/en/docs/performance.html">Performance</a> -->
    <dl>
      <dt>Production</dt>
      <dd><a href="/en/docs/production/forwarded.html">Forwarded</a></dd>
      <dd><a href="/en/docs/production/rate-limiting.html">Rate limiting</a></dd>
      <dd><a href="/en/docs/production/send-file.html">Send file</a></dd>
    </dl>
    <dl>
      <dt>Packages</dt>
      <dd><a href="/en/docs/packages/inphinit-proxy.html">Inphinit Proxy</a></dd>
    </dl>
  </nav>

  <div id="menu-backdrop"></div>
</body>
</html>

